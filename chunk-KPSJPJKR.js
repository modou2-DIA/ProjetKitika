import{a as K}from"./chunk-3NOMAPXL.js";import{a as H,b as V,d as B}from"./chunk-OUXBLQ6M.js";import{$b as y,Bb as o,Cb as r,Eb as u,Fb as _,Gb as k,Ib as g,Jb as l,Lc as N,Mc as P,Nc as $,Oc as A,Rc as W,Ub as a,Uc as j,V as S,Vb as v,Wb as C,Xa as s,Xb as h,_ as L,_b as b,ab as w,ac as E,ad as U,dc as O,dd as q,ec as f,hb as I,hc as R,ia as G,ic as F,id as z,ja as T,kc as M,mb as m,sb as D,tb as c,vd as J}from"./chunk-GEV565YZ.js";var x=class e{constructor(n){this.http=n}apiUrl=K+"guest-list";getGuestList(n){let t=new H;return n&&(t=t.set("date",n)),this.http.get(this.apiUrl,{params:t})}checkInReservation(n){return this.http.post(`http://localhost:8080/api/fiches-client/checkin/${n}`,{})}searchGuestList(n,t,i){return this.http.get(`${this.apiUrl}/search`,{params:{nom:n||"",prenom:t||"",entite:i||""}})}static \u0275fac=function(t){return new(t||e)(L(V))};static \u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"})};var Z=e=>({title:"R\xE9servations pr\xE9vues",data:e,cols:5}),ee=e=>({title:"Arriv\xE9es",data:e,cols:4}),te=e=>({title:"Clients pr\xE9sents",data:e,cols:3}),ne=e=>({title:"D\xE9parts",data:e,cols:3}),ie=(e,n,t,i)=>[e,n,t,i],re=()=>[];function oe(e,n){e&1&&(u(0),o(1,"th",21),a(2,"Client"),r(),o(3,"th",21),a(4,"T\xE9l\xE9phone"),r(),o(5,"th",21),a(6,"Chambre"),r(),o(7,"th",21),a(8,"P\xE9riode"),r(),o(9,"th",21),a(10,"Statut"),r(),_())}function se(e,n){e&1&&(u(0),o(1,"th",21),a(2,"Client"),r(),o(3,"th",21),a(4,"Chambre"),r(),o(5,"th",21),a(6,"T\xE9l\xE9phone"),r(),o(7,"th",21),a(8,"Action"),r(),_())}function ae(e,n){e&1&&(u(0),o(1,"th",21),a(2,"Client"),r(),o(3,"th",21),a(4,"Chambre"),r(),o(5,"th",21),a(6,"P\xE9riode"),r(),_())}function ce(e,n){if(e&1&&(o(0,"span"),a(1),r()),e&2){let t=l(2).$implicit;s(),C("\u2022 ",t.chambreType,"")}}function le(e,n){if(e&1&&(o(0,"td",22),a(1),m(2,ce,2,1,"span",20),r()),e&2){let t=l().$implicit;s(),C("",t.chambreNumero," "),s(),c("ngIf",t.chambreType)}}function pe(e,n){if(e&1&&(o(0,"td",22),a(1),r()),e&2){let t=l().$implicit;s(),v(t.clientTelephone||"-")}}function me(e,n){if(e&1&&(o(0,"td",22),a(1),r()),e&2){let t=l().$implicit,i=l(3);s(),h("",i.formatDate(t.dateDebut)," \u2192 ",i.formatDate(t.dateFin),"")}}function de(e,n){if(e&1&&(o(0,"td",22),a(1),r()),e&2){let t=l().$implicit;s(),v(t.statut)}}function ue(e,n){if(e&1){let t=k();o(0,"button",26),g("click",function(){G(t);let d=l(2).$implicit,p=l(3);return T(p.checkIn(d.reservationId))}),a(1," Check-In "),r()}}function _e(e,n){e&1&&(o(0,"span",27),a(1,"D\xE9j\xE0 check-in"),r())}function ge(e,n){if(e&1&&(o(0,"td",22),m(1,ue,2,0,"button",24)(2,_e,2,0,"span",25),r()),e&2){let t=l().$implicit;s(),c("ngIf",t.statut!=="Checked-in"),s(),c("ngIf",t.statut==="Checked-in")}}function fe(e,n){if(e&1&&(o(0,"tr")(1,"td",22),a(2),r(),m(3,le,3,2,"td",23)(4,pe,2,1,"td",23)(5,me,2,2,"td",23)(6,de,2,1,"td",23)(7,ge,3,2,"td",23),r()),e&2){let t=n.$implicit,i=l().$implicit;s(2),h("",t.clientNom," ",t.clientPrenom,""),s(),c("ngIf",i.cols>2),s(),c("ngIf",i.cols===4||i.cols===5),s(),c("ngIf",i.cols===5||i.cols===3),s(),c("ngIf",i.title==="R\xE9servations pr\xE9vues"),s(),c("ngIf",i.title==="Arriv\xE9es")}}function he(e,n){if(e&1&&(o(0,"tr")(1,"td",28),a(2,"Aucune donn\xE9e"),r()()),e&2){let t=l().$implicit;s(),D("colspan",t.cols)}}function xe(e,n){if(e&1&&(u(0),o(1,"section",13)(2,"h3",14),a(3),F(4,"date"),r(),o(5,"div",15)(6,"table",16)(7,"thead",17)(8,"tr"),u(9,18),m(10,oe,11,0,"ng-container",19)(11,se,9,0,"ng-container",19)(12,ae,7,0,"ng-container",19),_(),r()(),o(13,"tbody"),m(14,fe,8,7,"tr",12)(15,he,3,1,"tr",20),r()()()(),_()),e&2){let t=n.$implicit,i=l(2);s(3),h("",t.title," (",M(4,8,i.selectedDate,"dd/MM/yyyy"),")"),s(6),c("ngSwitch",t.cols),s(),c("ngSwitchCase",5),s(),c("ngSwitchCase",4),s(),c("ngSwitchCase",3),s(2),c("ngForOf",i.filtered(t.data)),s(),c("ngIf",(i.filtered(t.data)||O(11,re)).length===0)}}function ve(e,n){if(e&1&&(o(0,"div",11),m(1,xe,16,12,"ng-container",12),r()),e&2){let t=l();s(),c("ngForOf",R(9,ie,f(1,Z,t.guestList.reservationsPrevues),f(3,ee,t.guestList.arrivees),f(5,te,t.guestList.presents),f(7,ne,t.guestList.departs)))}}function Ce(e,n){e&1&&(o(0,"div",29),a(1,"Chargement ..."),r())}var Q=class e{constructor(n){this.service=n}selectedDate=new Date().toISOString().slice(0,10);searchTerm="";reservations=[];searchNom="";searchPrenom="";searchEntite="";guestList;ngOnInit(){this.load(),this.rechercher()}rechercher(){this.service.searchGuestList(this.searchNom,this.searchPrenom,this.searchEntite).subscribe(n=>{this.reservations=n})}load(){this.service.getGuestList(this.selectedDate).subscribe({next:n=>{this.guestList=n,this.applyFilter()},error:n=>{console.error("Erreur guest list",n)}})}applyFilter(){}filtered(n=[]){let t=this.searchTerm?.toLowerCase()?.trim()||"";return t?n.filter(i=>(i.clientNom||"").toLowerCase().includes(t)||(i.clientPrenom||"").toLowerCase().includes(t)||(i.chambreNumero||"").toLowerCase().includes(t)||(i.chambreType||"").toLowerCase().includes(t)):n||[]}formatDate(n){return n??"-"}checkIn(n){!n||!window.confirm("Confirmer le Check-In de cette r\xE9servation ?")||this.service.checkInReservation(n).subscribe({next:()=>{alert("Check-In effectu\xE9 avec succ\xE8s \u2705"),this.load()},error:i=>{console.error(i),alert("Erreur lors du Check-In \u274C")}})}static \u0275fac=function(t){return new(t||e)(w(x))};static \u0275cmp=I({type:e,selectors:[["app-guest-list"]],decls:15,vars:4,consts:[[1,"max-w-7xl","mx-auto","px-4","py-6"],[1,"text-2xl","font-bold","text-blue-800","mb-2"],[1,"text-gray-600","mb-6"],[1,"flex","flex-col","md:flex-row","md:flex-wrap","gap-4","items-center","mb-6"],[1,"flex","items-center","gap-2","w-full","md:w-auto"],[1,"text-sm"],["type","date",1,"border","px-3","py-2","rounded","w-full","md:w-auto",3,"ngModelChange","change","ngModel"],["type","text","placeholder","Rechercher (nom, chambre...)",1,"border","px-4","py-2","rounded","w-full","md:flex-1","md:w-1/3",3,"ngModelChange","input","ngModel"],[1,"bg-blue-600","text-white","px-4","py-2","rounded","hover:bg-blue-700","transition",3,"click"],["class","space-y-6",4,"ngIf"],["class","text-center text-gray-500 py-6",4,"ngIf"],[1,"space-y-6"],[4,"ngFor","ngForOf"],[1,"bg-white","shadow","rounded-lg","p-4"],[1,"font-semibold","text-lg","mb-3"],[1,"overflow-x-auto"],[1,"min-w-full","table-auto","text-sm"],[1,"bg-gray-100"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngIf"],[1,"px-3","py-2","text-left"],[1,"px-3","py-2"],["class","px-3 py-2",4,"ngIf"],["class","px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",3,"click",4,"ngIf"],["class","text-green-700 font-semibold",4,"ngIf"],[1,"px-3","py-1","bg-green-600","text-white","rounded","hover:bg-green-700",3,"click"],[1,"text-green-700","font-semibold"],[1,"px-3","py-4","text-center","text-gray-500"],[1,"text-center","text-gray-500","py-6"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"h2",1),a(2,"Guest List"),r(),o(3,"p",2),a(4,"Consultez la liste des clients pr\xE9sents, leurs r\xE9servations et les actions possibles."),r(),o(5,"div",3)(6,"label",4)(7,"span",5),a(8,"Date :"),r(),o(9,"input",6),E("ngModelChange",function(p){return y(i.selectedDate,p)||(i.selectedDate=p),p}),g("change",function(){return i.load()}),r()(),o(10,"input",7),E("ngModelChange",function(p){return y(i.searchTerm,p)||(i.searchTerm=p),p}),g("input",function(){return i.applyFilter()}),r(),o(11,"button",8),g("click",function(){return i.load()}),a(12,"Rafra\xEEchir"),r()(),m(13,ve,2,14,"div",9)(14,Ce,2,0,"div",10),r()),t&2&&(s(9),b("ngModel",i.selectedDate),s(),b("ngModel",i.searchTerm),s(3),c("ngIf",i.guestList),s(),c("ngIf",!i.guestList))},dependencies:[j,N,P,$,A,W,J,U,q,z,B],encapsulation:2})};export{Q as GuestListComponent};
