import{a as W}from"./chunk-3NOMAPXL.js";import{a as O,b as F,d as N}from"./chunk-FABKFREX.js";import{$b as E,$c as P,Bb as n,Cb as t,Gb as T,Ib as f,Jb as h,Jc as D,Kc as w,Qc as k,Ub as i,V as C,Vb as c,Xa as a,Xb as p,Yc as R,_ as S,_b as v,ab as I,ac as b,dc as g,ed as M,hb as G,ia as y,ja as L,mb as d,rd as A,tb as l}from"./chunk-SG55GJBE.js";var x=class s{constructor(r){this.http=r}apiUrl=W+"guest-list";getGuestList(r){let e=new O;return r&&(e=e.set("date",r)),this.http.get(this.apiUrl,{params:e})}checkInReservation(r){return this.http.post(`http://localhost:8080/api/fiches-client/checkin/${r}`,{})}searchGuestList(r,e,o){return this.http.get(`${this.apiUrl}/search`,{params:{nom:r||"",prenom:e||"",entite:o||""}})}static \u0275fac=function(e){return new(e||s)(S(F))};static \u0275prov=C({token:s,factory:s.\u0275fac,providedIn:"root"})};var _=()=>[];function U(s,r){if(s&1&&(n(0,"tr")(1,"td",17),i(2),t(),n(3,"td",17),i(4),t(),n(5,"td",17),i(6),t(),n(7,"td",17),i(8),t(),n(9,"td",17),i(10),t()()),s&2){let e=r.$implicit,o=h(2);a(2),p("",e.clientNom," ",e.clientPrenom,""),a(2),c(e.clientTelephone||"-"),a(2),p("",e.chambreNumero," \u2022 ",e.chambreType,""),a(2),p("",o.formatDate(e.dateDebut)," \u2192 ",o.formatDate(e.dateFin),""),a(2),c(e.statut)}}function $(s,r){s&1&&(n(0,"tr")(1,"td",18),i(2,"Aucune r\xE9servation pr\xE9vue"),t()())}function B(s,r){if(s&1){let e=T();n(0,"button",21),f("click",function(){y(e);let u=h().$implicit,m=h(2);return L(m.checkIn(u.reservationId))}),i(1," Check-In "),t()}}function q(s,r){s&1&&(n(0,"span",22),i(1,"D\xE9j\xE0 check-in"),t())}function z(s,r){if(s&1&&(n(0,"tr")(1,"td",17),i(2),t(),n(3,"td",17),i(4),t(),n(5,"td",17),i(6),t(),n(7,"td",17),d(8,B,2,0,"button",19)(9,q,2,0,"span",20),t()()),s&2){let e=r.$implicit;a(2),p("",e.clientNom," ",e.clientPrenom,""),a(2),c(e.chambreNumero),a(2),c(e.clientTelephone||"-"),a(2),l("ngIf",e.statut!=="Checked-in"),a(),l("ngIf",e.statut==="Checked-in")}}function J(s,r){s&1&&(n(0,"tr")(1,"td",23),i(2,"Aucune arriv\xE9e"),t()())}function K(s,r){if(s&1&&(n(0,"tr")(1,"td",17),i(2),t(),n(3,"td",17),i(4),t(),n(5,"td",17),i(6),t()()),s&2){let e=r.$implicit,o=h(2);a(2),p("",e.clientNom," ",e.clientPrenom,""),a(2),c(e.chambreNumero),a(2),p("",o.formatDate(e.dateDebut)," \u2192 ",o.formatDate(e.dateFin),"")}}function Q(s,r){s&1&&(n(0,"tr")(1,"td",24),i(2,"Aucun client pr\xE9sent"),t()())}function X(s,r){if(s&1&&(n(0,"tr")(1,"td",17),i(2),t(),n(3,"td",17),i(4),t(),n(5,"td",17),i(6),t()()),s&2){let e=r.$implicit;a(2),p("",e.clientNom," ",e.clientPrenom,""),a(2),c(e.chambreNumero),a(2),c(e.clientTelephone||"-")}}function Y(s,r){s&1&&(n(0,"tr")(1,"td",24),i(2,"Aucun d\xE9part pr\xE9vu"),t()())}function Z(s,r){if(s&1&&(n(0,"div")(1,"section",11)(2,"h3",12),i(3,"R\xE9servations pr\xE9vues (pr\xE9sence sur la date s\xE9lectionn\xE9e)"),t(),n(4,"table",13)(5,"thead",14)(6,"tr")(7,"th",15),i(8,"Client"),t(),n(9,"th",15),i(10,"T\xE9l\xE9phone"),t(),n(11,"th",15),i(12,"Chambre"),t(),n(13,"th",15),i(14,"P\xE9riode"),t(),n(15,"th",15),i(16,"Statut"),t()()(),n(17,"tbody"),d(18,U,11,8,"tr",16)(19,$,3,0,"tr",9),t()()(),n(20,"section",11)(21,"h3",12),i(22,"Arriv\xE9es (date s\xE9lectionn\xE9e)"),t(),n(23,"table",13)(24,"thead",14)(25,"tr")(26,"th",15),i(27,"Client"),t(),n(28,"th",15),i(29,"Chambre"),t(),n(30,"th",15),i(31,"T\xE9l\xE9phone"),t(),n(32,"th",15),i(33,"Action"),t()()(),n(34,"tbody"),d(35,z,10,6,"tr",16)(36,J,3,0,"tr",9),t()()(),n(37,"section",11)(38,"h3",12),i(39,"Clients pr\xE9sents (check-in)"),t(),n(40,"table",13)(41,"thead",14)(42,"tr")(43,"th",15),i(44,"Client"),t(),n(45,"th",15),i(46,"Chambre"),t(),n(47,"th",15),i(48,"P\xE9riode"),t()()(),n(49,"tbody"),d(50,K,7,5,"tr",16)(51,Q,3,0,"tr",9),t()()(),n(52,"section",11)(53,"h3",12),i(54,"D\xE9parts (date s\xE9lectionn\xE9e)"),t(),n(55,"table",13)(56,"thead",14)(57,"tr")(58,"th",15),i(59,"Client"),t(),n(60,"th",15),i(61,"Chambre"),t(),n(62,"th",15),i(63,"T\xE9l\xE9phone"),t()()(),n(64,"tbody"),d(65,X,7,4,"tr",16)(66,Y,3,0,"tr",9),t()()()()),s&2){let e=h();a(18),l("ngForOf",e.filtered(e.guestList.reservationsPrevues)),a(),l("ngIf",(e.filtered(e.guestList.reservationsPrevues)||g(8,_)).length===0),a(16),l("ngForOf",e.filtered(e.guestList.arrivees)),a(),l("ngIf",(e.filtered(e.guestList.arrivees)||g(9,_)).length===0),a(14),l("ngForOf",e.filtered(e.guestList.presents)),a(),l("ngIf",(e.filtered(e.guestList.presents)||g(10,_)).length===0),a(14),l("ngForOf",e.filtered(e.guestList.departs)),a(),l("ngIf",(e.filtered(e.guestList.departs)||g(11,_)).length===0)}}function ee(s,r){s&1&&(n(0,"div",25),i(1,"Chargement ..."),t())}var j=class s{constructor(r){this.service=r}selectedDate=new Date().toISOString().slice(0,10);searchTerm="";reservations=[];searchNom="";searchPrenom="";searchEntite="";guestList;ngOnInit(){this.load(),this.rechercher()}rechercher(){this.service.searchGuestList(this.searchNom,this.searchPrenom,this.searchEntite).subscribe(r=>{this.reservations=r})}load(){this.service.getGuestList(this.selectedDate).subscribe({next:r=>{this.guestList=r,this.applyFilter()},error:r=>{console.error("Erreur guest list",r)}})}applyFilter(){}filtered(r=[]){let e=this.searchTerm?.toLowerCase()?.trim()||"";return e?r.filter(o=>(o.clientNom||"").toLowerCase().includes(e)||(o.clientPrenom||"").toLowerCase().includes(e)||(o.chambreNumero||"").toLowerCase().includes(e)||(o.chambreType||"").toLowerCase().includes(e)):r||[]}formatDate(r){return r??"-"}checkIn(r){!r||!window.confirm("Confirmer le Check-In de cette r\xE9servation ?")||this.service.checkInReservation(r).subscribe({next:()=>{alert("Check-In effectu\xE9 avec succ\xE8s \u2705"),this.load()},error:o=>{console.error(o),alert("Erreur lors du Check-In \u274C")}})}static \u0275fac=function(e){return new(e||s)(I(x))};static \u0275cmp=G({type:s,selectors:[["app-guest-list"]],decls:15,vars:4,consts:[[1,"container","mx-auto","p-6"],[1,"text-2xl","font-bold","text-blue-800","mb-4"],[1,"text-gray-600","mb-4"],[1,"flex","flex-wrap","gap-4","items-center","mb-4"],[1,"flex","items-center","gap-2"],[1,"text-sm"],["type","date",1,"border","px-2","py-1","rounded",3,"ngModelChange","change","ngModel"],["type","text","placeholder","Rechercher (nom, chambre...)",1,"border","px-3","py-1","rounded","flex-1","md:w-1/3",3,"ngModelChange","input","ngModel"],[1,"bg-blue-600","text-white","px-4","py-2","rounded",3,"click"],[4,"ngIf"],["class","text-center text-gray-500 p-6",4,"ngIf"],[1,"mb-6","bg-white","shadow","rounded","p-4"],[1,"font-semibold","mb-2"],[1,"w-full","table-auto"],[1,"bg-gray-100"],[1,"px-3","py-2","text-left"],[4,"ngFor","ngForOf"],[1,"px-3","py-2"],["colspan","5",1,"px-3","py-4","text-center","text-gray-500"],["class","px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",3,"click",4,"ngIf"],["class","text-green-700 font-semibold",4,"ngIf"],[1,"px-3","py-1","bg-green-600","text-white","rounded","hover:bg-green-700",3,"click"],[1,"text-green-700","font-semibold"],["colspan","4",1,"px-3","py-4","text-center","text-gray-500"],["colspan","3",1,"px-3","py-4","text-center","text-gray-500"],[1,"text-center","text-gray-500","p-6"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"h2",1),i(2,"Guest List"),t(),n(3,"p",2),i(4,"Consultez la liste des clients pr\xE9sents, leurs r\xE9servations et les actions possibles."),t(),n(5,"div",3)(6,"label",4)(7,"span",5),i(8,"Date :"),t(),n(9,"input",6),b("ngModelChange",function(m){return E(o.selectedDate,m)||(o.selectedDate=m),m}),f("change",function(){return o.load()}),t()(),n(10,"input",7),b("ngModelChange",function(m){return E(o.searchTerm,m)||(o.searchTerm=m),m}),f("input",function(){return o.applyFilter()}),t(),n(11,"button",8),f("click",function(){return o.load()}),i(12,"Rafra\xEEchir"),t()(),d(13,Z,67,12,"div",9)(14,ee,2,0,"div",10),t()),e&2&&(a(9),v("ngModel",o.selectedDate),a(),v("ngModel",o.searchTerm),a(3),l("ngIf",o.guestList),a(),l("ngIf",!o.guestList))},dependencies:[k,D,w,A,R,P,M,N],encapsulation:2})};export{j as GuestListComponent};
