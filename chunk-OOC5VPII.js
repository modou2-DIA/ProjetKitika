import{a as u}from"./chunk-3NOMAPXL.js";import{b as l}from"./chunk-FABKFREX.js";import{T as s,V as a,_ as n,j as o}from"./chunk-SG55GJBE.js";var c=class i{constructor(e){this.http=e;this.checkInitialAuthStatus()}api=u+"auth";_isAuthenticated=new o(!1);_userRole=new o(null);_userName=new o(null);authStatus$=this._isAuthenticated.asObservable();userRole$=this._userRole.asObservable();userName$=this._userName.asObservable();isBrowser(){return typeof window<"u"&&typeof localStorage<"u"}checkInitialAuthStatus(){if(this.isBrowser()){let e=localStorage.getItem("token"),t=localStorage.getItem("role"),r=localStorage.getItem("userName");e&&(this._isAuthenticated.next(!0),this._userRole.next(t),this._userName.next(r))}}login(e,t){return this.http.post(`${this.api}/login`,{email:e,motDePasse:t}).pipe(s(r=>{this.isBrowser()&&(localStorage.setItem("token",r.token),localStorage.setItem("role",r.role),localStorage.setItem("userName",r.nom),this._isAuthenticated.next(!0),this._userRole.next(r.role),this._userName.next(r.nom))}))}getToken(){return this.isBrowser()?localStorage.getItem("token"):null}logout(){this.isBrowser()&&(localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("userName"),this._isAuthenticated.next(!1),this._userRole.next(null),this._userName.next(null))}isAuthenticated(){return this._isAuthenticated.value}getRole(){return this._userRole.value}hasAnyRole(e){let t=this.getRole();return t?t==="ADMIN"?!0:(Array.isArray(e)?e:[e]).includes(t):!1}getUserName(){return this._userName.value}static \u0275fac=function(t){return new(t||i)(n(l))};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};export{c as a};
