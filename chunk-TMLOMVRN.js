import{a as P}from"./chunk-3NOMAPXL.js";import{Bc as A,Ec as L,Hb as i,Ib as s,Jb as C,La as r,Lc as I,Mc as N,Nb as p,Ob as u,Pb as g,Qa as _,Rc as T,U as y,Uc as W,Wb as E,Xa as S,Yb as v,Z as x,Zc as k,ab as h,hb as b,kd as F,pb as t,qb as e,wb as c,wc as w,xc as M}from"./chunk-OKTVRY6G.js";var f=class m{constructor(l){this.http=l}api=P+"audit";search(l){let a=new I;return Object.entries(l).forEach(([n,d])=>{d!=null&&d!==""&&(a=a.set(n,String(d)))}),this.http.get(this.api,{params:a})}static \u0275fac=function(a){return new(a||m)(x(N))};static \u0275prov=y({token:m,factory:m.\u0275fac,providedIn:"root"})};function O(m,l){m&1&&(t(0,"div",21),i(1,"Chargement\u2026"),e())}function j(m,l){if(m&1&&(t(0,"tr")(1,"td",22),i(2),E(3,"date"),e(),t(4,"td",22),i(5),e(),t(6,"td",23),i(7),e(),t(8,"td",22),i(9),e(),t(10,"td",22),i(11),e(),t(12,"td",24),i(13),e()()),m&2){let a=l.$implicit;r(2),s(v(3,6,a.dateHeure,"short")),r(3),s(a.utilisateur),r(2),s(a.action),r(2),s(a.tableName),r(2),s(a.recordId),r(2),s(a.details)}}var B=class m{constructor(l){this.service=l}logs=[];total=0;page=0;size=20;from=null;to=null;action="";tableName="";utilisateur="";sortBy="dateHeure";dir="DESC";loading=!1;ngOnInit(){this.load()}load(){this.loading=!0,this.service.search({from:this.from||"",to:this.to||"",action:this.action,tableName:this.tableName,utilisateur:this.utilisateur,page:this.page,size:this.size,sortBy:this.sortBy,dir:this.dir}).subscribe({next:l=>{this.logs=l.content||l,this.total=l.totalElements??this.logs.length,this.loading=!1},error:()=>{this.loading=!1}})}clearFilters(){this.from=null,this.to=null,this.action="",this.tableName="",this.utilisateur="",this.page=0,this.load()}prev(){this.page>0&&(this.page--,this.load())}next(){this.page++,this.load()}static \u0275fac=function(a){return new(a||m)(_(f))};static \u0275cmp=S({type:m,selectors:[["app-audit-log"]],decls:56,vars:8,consts:[[1,"p-6","max-w-6xl","mx-auto","bg-white","rounded","shadow"],[1,"text-2xl","font-semibold","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-3","mb-4"],[1,"block","text-xs","text-gray-600"],["type","date",1,"border","rounded","px-2","py-1","w-full",3,"ngModelChange","ngModel"],["type","text","placeholder","CREATE / UPDATE / CHECKIN ...",1,"border","rounded","px-2","py-1","w-full",3,"ngModelChange","ngModel"],["type","text","placeholder","Reservation, Facture...",1,"border","rounded","px-2","py-1","w-full",3,"ngModelChange","ngModel"],["type","text","placeholder","login / nom",1,"border","rounded","px-2","py-1","w-full",3,"ngModelChange","ngModel"],[1,"flex","gap-2","mb-4"],[1,"bg-blue-600","text-white","px-4","py-2","rounded",3,"click"],[1,"border","px-3","py-2","rounded",3,"click"],["class","mb-4 text-sm text-gray-600",4,"ngIf"],[1,"overflow-x-auto"],[1,"w-full","table-auto"],[1,"bg-gray-100"],[1,"px-3","py-2","text-left"],[4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","mt-4"],[1,"text-sm","text-gray-600"],[1,"flex","gap-2"],[1,"px-3","py-1","border","rounded",3,"click"],[1,"mb-4","text-sm","text-gray-600"],[1,"px-3","py-2"],[1,"px-3","py-2","font-medium"],[1,"px-3","py-2","break-words","max-w-xl","text-sm","text-gray-700"]],template:function(a,n){a&1&&(t(0,"div",0)(1,"h2",1),i(2,"Historique des actions (Mouchard)"),e(),t(3,"div",2)(4,"div")(5,"label",3),i(6,"Du"),e(),t(7,"input",4),g("ngModelChange",function(o){return u(n.from,o)||(n.from=o),o}),e()(),t(8,"div")(9,"label",3),i(10,"Au"),e(),t(11,"input",4),g("ngModelChange",function(o){return u(n.to,o)||(n.to=o),o}),e()(),t(12,"div")(13,"label",3),i(14,"Action"),e(),t(15,"input",5),g("ngModelChange",function(o){return u(n.action,o)||(n.action=o),o}),e()(),t(16,"div")(17,"label",3),i(18,"Table"),e(),t(19,"input",6),g("ngModelChange",function(o){return u(n.tableName,o)||(n.tableName=o),o}),e()(),t(20,"div")(21,"label",3),i(22,"Utilisateur"),e(),t(23,"input",7),g("ngModelChange",function(o){return u(n.utilisateur,o)||(n.utilisateur=o),o}),e()()(),t(24,"div",8)(25,"button",9),c("click",function(){return n.load()}),i(26,"Filtrer"),e(),t(27,"button",10),c("click",function(){return n.clearFilters()}),i(28,"R\xE9initialiser"),e()(),h(29,O,2,0,"div",11),t(30,"div",12)(31,"table",13)(32,"thead",14)(33,"tr")(34,"th",15),i(35,"Date"),e(),t(36,"th",15),i(37,"Utilisateur"),e(),t(38,"th",15),i(39,"Action"),e(),t(40,"th",15),i(41,"Table"),e(),t(42,"th",15),i(43,"Record"),e(),t(44,"th",15),i(45,"D\xE9tails"),e()()(),t(46,"tbody"),h(47,j,14,9,"tr",16),e()()(),t(48,"div",17)(49,"div",18),i(50),e(),t(51,"div",19)(52,"button",20),c("click",function(){return n.prev()}),i(53,"Pr\xE9c\xE9dent"),e(),t(54,"button",20),c("click",function(){return n.next()}),i(55,"Suivant"),e()()()()),a&2&&(r(7),p("ngModel",n.from),r(4),p("ngModel",n.to),r(4),p("ngModel",n.action),r(4),p("ngModel",n.tableName),r(4),p("ngModel",n.utilisateur),r(6),b("ngIf",n.loading),r(18),b("ngForOf",n.logs),r(3),C("Total : ",n.total,""))},dependencies:[L,w,M,A,F,T,W,k],encapsulation:2})};export{B as AuditLogComponent};
