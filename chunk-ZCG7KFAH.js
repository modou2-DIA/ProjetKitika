import{a as u}from"./chunk-3NOMAPXL.js";import{Mc as n,S as s,U as a,Z as l,j as o}from"./chunk-OKTVRY6G.js";var c=class i{constructor(t){this.http=t;this.checkInitialAuthStatus()}api=u+"auth";_isAuthenticated=new o(!1);_userRole=new o(null);_userName=new o(null);authStatus$=this._isAuthenticated.asObservable();userRole$=this._userRole.asObservable();userName$=this._userName.asObservable();isBrowser(){return typeof window<"u"&&typeof localStorage<"u"}checkInitialAuthStatus(){if(this.isBrowser()){let t=localStorage.getItem("token"),r=localStorage.getItem("role"),e=localStorage.getItem("userName");t&&(this._isAuthenticated.next(!0),this._userRole.next(r),this._userName.next(e))}}login(t,r){return this.http.post(`${this.api}/login`,{email:t,motDePasse:r}).pipe(s(e=>{this.isBrowser()&&(localStorage.setItem("token",e.token),localStorage.setItem("role",e.role),localStorage.setItem("userName",e.nom),this._isAuthenticated.next(!0),this._userRole.next(e.role),this._userName.next(e.nom))}))}getToken(){return this.isBrowser()?localStorage.getItem("token"):null}logout(){this.isBrowser()&&(localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("userName"),this._isAuthenticated.next(!1),this._userRole.next(null),this._userName.next(null))}isAuthenticated(){return this._isAuthenticated.value}getRole(){return this._userRole.value}getUserName(){return this._userName.value}static \u0275fac=function(r){return new(r||i)(l(n))};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};export{c as a};
